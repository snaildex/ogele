{
  "type": "RenderPipeline",
  "name": "DeferredPBR",
  "tags": [ "Main" ],
  "textures": [
    {
      "name": "Skybox",
      "type": "SingleCubeMap",
      "format": "RGBA16F",
      "minFilter": "linearMipMapNearest",
      "magFilter": "linear",
      "width": 512,
      "height": 512
    },
    {
      "name": "BRDFLUT",
      "type": "Single2D",
      "wrap": "clampToEdge",
      "minFilter": "linear",
      "magFilter": "linear",
      "file": "BRDFLUT.bmp"
    },
    {
      "name": "CloudDensity",
      "type": "Single3D",
      "format": "R16F",
      "wrap": "repeat",
      "minFilter": "linear",
      "magFilter": "linear",
      "width": 512,
      "height": 8,
      "depth": 512
    },
    {
      "name": "CloudNoise",
      "type": "Single3D",
      "format": "R16F",
      "wrap": "repeat",
      "minFilter": "linear",
      "magFilter": "linear",
      "width": 64,
      "height": 64,
      "depth": 64
    }
  ],
  "targets": [
    {
      "name": "GBuffer",
      "colorTex": [ "AlbedoRough", "PosDepth", "NormalMetal", "Emission" ],
      "format": "RGBA16F",
      "minFilter": "nearest",
      "magFilter": "nearest",
      "mipmaps": false,
      "depthBuffer": true,
      "stencilBuffer": false
    },
    {
      "name": "Clouds",
      "colorTex": [ "Clouds" ],
      "format": "RGB16F"
    },
    {
      "name": "FinalHDR",
      "colorTex": [ "HDRFrame" ],
      "format": "RGB16F"
    },
    {
      "name": "Final",
      "colorTex": [ "FinalTex" ],
      "format": "RGB8"
    }
  ],
  "pass": [
    {
      "name": "Generate skybox",
      "mode": "compute",
      "shader": "Skybox",
      "mipmap": [ "Skybox" ],
      "groupNum": [ 16, 16, 6 ]
    },
    {
      "name": "Generate cloud density",
      "mode": "compute",
      "shader": "GenClouds",
      "groupNum": [ 16, 8, 16 ]
    },
    {
      "name": "Generate cloud noise",
      "mode": "compute",
      "shader": "GenCloudNoise",
      "groupNum": [ 2, 64, 2 ]
    },
    {
      "name": "Draw clouds",
      "mode": "screen",
      "shader": "RenderClouds",
      "target": "Clouds"
    },
    {
      "name": "G-Pass",
      "mode": "scene",
      "clear": [ "Color", "Depth" ],
      "tags": [ "Opaque" ],
      "shader": [ "PBR" ],
      "target": "GBuffer"
    },
    {
      "name": "Lighting",
      "mode": "screen",
      "shader": "LightingCompute",
      "target": "FinalHDR"
    },
    {
      "name": "Tonemapping",
      "mode": "screen",
      "shader": "Tonemapping",
      "target": "Final"
    }
  ]
}